(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3930:()=>{},7324:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var r=n(5155),a=n(2115);n(9014),n(3930);let i=async e=>{let t={},n=e.map(e=>new Promise(n=>{let r=new Image;r.src=e,r.onload=()=>{t[e]=r,n()}}));return await Promise.all(n),t},s=[{key:"scene_1",frames:["/ground/scene_1/scene_a.png","/ground/scene_1/scene_b.png"]},{key:"scene_2",frames:["/ground/scene_2/scene_a.png","/ground/scene_2/scene_b.png"]},{key:"scene_3",frames:["/ground/scene_3/scene_a.png","/ground/scene_3/scene_b.png"]},{key:"scene_4",frames:["/ground/scene_4/scene_a.png","/ground/scene_4/scene_b.png"]}],o=[{from:"scene_1",to:"scene_2",frame:"/ground/transitions/transition_1.png"},{from:"scene_2",to:"scene_3",frame:"/ground/transitions/transition_2.png"},{from:"scene_3",to:"scene_4",frame:"/ground/transitions/transition_3.png"},{from:"scene_4",to:"scene_1",frame:"/ground/transitions/transition_4.png"}],l=[{key:"start",duration:1,frameRate:0,frames:["/sprite/start1.png","/sprite/start2.png"],oneShot:!0,holdLastFrame:!0},{key:"run",duration:"auto",frameRate:9.5,frames:["/sprite/run1.png","/sprite/run2.png"],oneShot:!1,holdLastFrame:!1},{key:"jump",duration:1,frameRate:0,frames:["/sprite/jump1.png","/sprite/jump2.png","/sprite/jump3.png","/sprite/jump4.png","/sprite/jump5.png"],oneShot:!0,holdLastFrame:!1},{key:"disappear",duration:4,frameRate:0,frames:[],oneShot:!1,holdLastFrame:!1}],u=(()=>{let e=(90-l.reduce((e,t)=>e+("number"==typeof t.duration?t.duration:0),0))/Math.max(1,l.filter(e=>"auto"===e.duration).length),t=0;return l.map(n=>{let r="number"==typeof n.duration?n.duration:e,a={key:n.key,start:t,end:t+r,duration:r,frameRate:n.frameRate,frames:n.frames,oneShot:!!n.oneShot,holdLastFrame:!!n.holdLastFrame};return t+=r,a})})(),c={scale:.2,offsetX:0,offsetY:0};function d(){let e=u.find(e=>"run"===e.key);if(!e)return[];let t=e.start,n=e.duration,r=t+n,a=[];s.forEach((e,t)=>{a.push(...e.frames);let n=s[(t+1)%s.length].key,r=o.find(t=>t.from===e.key&&t.to===n);r&&a.push(r.frame)});let i=s[0].frames,l=i.slice(0,2).concat(i[0]),c=a.length,d=l.length,h=Math.max(0,n-5),m=c>0?h/c:0,f=d>0?5/d:0,g=[],p=t;for(let e of a){let t=p,n=Math.min(p+m,r);n>t&&g.push({imagePath:e,startTime:t,endTime:n}),p=n}for(let e of l){let t=p,n=Math.min(p+f,r);n>t&&g.push({imagePath:e,startTime:t,endTime:n}),p=n}return g.length&&(g[g.length-1].endTime=r),g}let h=d(),m=e=>e.startsWith("/")?e:"/"+e,f={enabled:!0,in:{start:0,duration:1.5,ease:"outCubic"},out:{start:82,duration:8,ease:"inCubic"}};function g(e,t){let n=Math.min(1,Math.max(0,e));return"outCubic"===t?1-Math.pow(1-n,3):Math.pow(n,3)}function p(e){let{canvas:t,ctx:n,currentTime:r}=e,[l,p]=(0,a.useState)({});return(0,a.useEffect)(()=>{i([...s.flatMap(e=>e.frames),...o.map(e=>e.frame),...u.flatMap(e=>e.frames)]).then(p)},[]),(0,a.useEffect)(()=>{t&&n&&0!==Object.keys(l).length&&(n.clearRect(0,0,t.width,t.height),function(e,t,n){let r=n%90/45,a=r<=1?r:2-r,i=(e,t,n)=>Math.round(e+(t-e)*n),s=i(135,25,a),o=i(206,25,a),l=i(235,112,a);e.fillStyle="rgb(".concat(s,", ").concat(o,", ").concat(l,")"),e.fillRect(0,0,t.width,t.height)}(n,t,r),function(e,t,n,r){var a,i,s;let o=h.findIndex(e=>n>=e.startTime&&n<e.endTime);if(-1===o){let s=r[m((n<(null!=(i=null==(a=h[0])?void 0:a.startTime)?i:0)?h[0]:h.at(-1)).imagePath)];if(s){let n=t.height-s.height;e.drawImage(s,0,n)}return}let l=h[o],u=h[o+1],c=r[m(l.imagePath)];if(!c)return;if(!u){let n=t.height-c.height;e.drawImage(c,0,n);return}let d=(n-l.startTime)/(l.endTime-l.startTime),f=null!=(s=r[m(u.imagePath)])?s:c,g=t.width,p=g*Math.min(Math.max(d,0),1),_=t.height-c.height;e.drawImage(c,-p,_),e.drawImage(f,g-p,_)}(n,t,r,l),function(e,t,n,r){let a=function(){let e=d();return e.length<2?0:e[e.length-1].startTime}();if(n<1){let a=["/sprite/start1.png","/sprite/start2.png"],i=Math.min(1,Math.floor(n/1*a.length)),s=r[a[i]];if(!s)return;let{scale:o,offsetX:l,offsetY:u}=c,d=s.width*o,h=s.height*o,m=(t.width-d)/2+l,f=t.height-h-t.height*u;e.drawImage(s,m,f,d,h);return}if(n<a){let a=["/sprite/run1.png","/sprite/run2.png"],i=Math.floor((n-1)*9.5)%a.length,s=r[a[i]];if(!s)return;let{scale:o,offsetX:l,offsetY:u}=c,d=s.width*o,h=s.height*o,m=(t.width-d)/2+l,f=t.height-h-t.height*u;e.drawImage(s,m,f,d,h);return}if(n<a+1){let i=["/sprite/jump1.png","/sprite/jump2.png","/sprite/jump3.png","/sprite/jump4.png","/sprite/jump5.png"],s=1/i.length,o=Math.min(i.length-1,Math.floor((n-a)/s)),l=r[i[o]];if(!l)return;let{scale:u,offsetX:d,offsetY:h}=c,m=l.width*u,f=l.height*u,g=(t.width-m)/2+d,p=t.height-f-t.height*h;e.drawImage(l,g,p,m,f)}}(n,t,r,l),function(e,t,n){let{enabled:r,in:a,out:i}=f;if(!r)return;let s=0;n>=a.start&&n<a.start+a.duration?s=Math.max(s,1-g((n-a.start)/a.duration,a.ease)):n<a.start&&(s=Math.max(s,1)),n>=i.start&&(s=Math.max(s,g((n-i.start)/i.duration,i.ease))),s<=0||(e.save(),e.globalAlpha=s,e.fillStyle="#000",e.fillRect(0,0,t.width,t.height),e.restore())}(n,t,r))},[t,n,r,l]),null}function _(e){let{currentTime:t,isPlaying:n}=e,i=(0,a.useRef)(null),[s,o]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=i.current;if(!e)return;let t=e.getContext("2d");t&&o(t);let n=()=>{e.width=800,e.height=400};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),(0,r.jsxs)("div",{className:"canvas-wrapper",children:[(0,r.jsx)("canvas",{ref:i,className:"animation-canvas"}),(0,r.jsx)(p,{canvas:i.current,ctx:s,currentTime:t,isPlaying:n})]})}function w(){let e=(0,a.useRef)(null),[t,n]=(0,a.useState)(!1),[i,s]=(0,a.useState)(0),[o,l]=(0,a.useState)(0),u=()=>{let t=e.current;t&&(t.pause(),t.currentTime=0,n(!1),s(0))};(0,a.useEffect)(()=>{let t=e.current;if(!t)return;let n=()=>s(t.currentTime),r=()=>{t.duration&&0===o&&l(t.duration)},a=()=>u();t.addEventListener("timeupdate",n),t.addEventListener("loadedmetadata",r),t.addEventListener("ended",a);let i=setTimeout(r,1500);return()=>{t.removeEventListener("timeupdate",n),t.removeEventListener("loadedmetadata",r),t.removeEventListener("ended",a),clearTimeout(i)}},[o]),(0,a.useEffect)(()=>{i>=90&&u()},[i]);let c=e=>{let t=Math.floor(e/60),n=Math.floor(e%60).toString().padStart(2,"0");return"".concat(t,":").concat(n)},d=o?i/o*100:0;return(0,r.jsxs)("div",{className:"controller",children:[(0,r.jsxs)("audio",{ref:e,preload:"auto",style:{display:"none"},children:[(0,r.jsx)("source",{src:"/music/song.mp3",type:"audio/mpeg"}),"Your browser does not support the audio element."]}),(0,r.jsx)("div",{className:"animation-wrapper",children:(0,r.jsx)(_,{isPlaying:t,currentTime:i})}),(0,r.jsx)("div",{className:"controller-controls",children:(0,r.jsxs)("div",{className:"controller-bar",children:[(0,r.jsxs)("div",{className:"controller-buttons",children:[(0,r.jsx)("button",{onClick:()=>{let t=e.current;t&&(t.paused?(t.play(),n(!0)):(t.pause(),n(!1)))},title:t?"Pause":"Play",children:t?"⏸️":"▶️"}),(0,r.jsx)("button",{onClick:u,title:"Restart",children:"\uD83D\uDD04"})]}),(0,r.jsx)("div",{className:"controller-track",onClick:t=>{let n=e.current;if(!n||!o)return;let r=t.currentTarget.getBoundingClientRect();n.currentTime=(t.clientX-r.left)/r.width*o},children:(0,r.jsx)("div",{className:"progress",style:{width:"".concat(d,"%")}})}),(0,r.jsxs)("div",{className:"controller-time",children:[c(i)," / ",c(o)]})]})})]})}function v(){return(0,r.jsx)("main",{children:(0,r.jsx)(w,{})})}},8563:(e,t,n)=>{Promise.resolve().then(n.bind(n,7324))},9014:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[233,441,684,358],()=>t(8563)),_N_E=e.O()}]);