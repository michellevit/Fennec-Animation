(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3930:()=>{},7300:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(5155),a=r(2115);r(9014),r(3930);let s={start:["/sprite/start1.png","/sprite/start2.png"],run:["/sprite/run1.png","/sprite/run2.png"],jump:["/sprite/jump1.png","/sprite/jump2.png","/sprite/jump3.png","/sprite/jump4.png","/sprite/jump5.png"]},i={start:{frames:s.start,frameRate:1},run:{frames:s.run,frameRate:15},jump:{frames:s.jump,frameRate:10}},l=(()=>{let e=i.start.frames.length/i.start.frameRate,t=90-(e+i.jump.frames.length/i.jump.frameRate);return{start:{start:0,end:e},run:{start:e,end:e+t},jump:{start:e+t,end:90}}})(),u={run:6,jump:10},o={scale:.2,offsetX:0,offsetY:0},d=[{duration:10,frames:["/ground/scene1a.png","/ground/scene1b.png"]},{duration:10,frames:["/ground/transition1.png"]},{duration:10,frames:["/ground/scene2a.png","/ground/scene2b.png"]},{duration:10,frames:["/ground/transition2.png"]},{duration:10,frames:["/ground/scene3a.png","/ground/scene3b.png"]},{duration:10,frames:["/ground/transition3.png"]},{duration:10,frames:["/ground/scene1a.png","/ground/scene1b.png"]}],c=async e=>{let t={},r=e.map(e=>new Promise(r=>{let n=new Image;n.src=e,n.onload=()=>{t[e]=n,r()}}));return await Promise.all(r),t};function m(e){let{canvas:t,ctx:r,currentTime:n}=e,[i,m]=(0,a.useState)({});return(0,a.useEffect)(()=>{let e=d.flatMap(e=>e.frames);c([...s.start,...s.run,...s.jump,...e]).then(m)},[]),(0,a.useEffect)(()=>{t&&r&&0!==Object.keys(i).length&&(r.clearRect(0,0,t.width,t.height),function(e,t,r){let n=r%90/45,a=n<=1?n:2-n,s=(e,t,r)=>Math.round(e+(t-e)*r),i=s(135,25,a),l=s(206,25,a),u=s(235,112,a);e.fillStyle="rgb(".concat(i,", ").concat(l,", ").concat(u,")"),e.fillRect(0,0,t.width,t.height)}(r,t,n),function(e,t,r,n){var a;let s,i=r>=l.run.start+.05&&r<l.run.end,u=0,o=-1;for(let e=0;e<d.length;e++){let t=d[e];if(r>=u&&r<u+t.duration){o=e,s={...t,startTime:u};break}u+=t.duration}if(!s)return;let c=r-s.startTime,m=1===s.frames.length,f=t.width*(m?2:1)/s.duration,g=c<2?c**3/4:c-1,p=i?g*f:0,h=t.height-((null==(a=n[s.frames[0]])?void 0:a.height)||0);if(m&&o>0&&o<d.length-1){let r=d[o-1],a=d[o+1],i=r.frames.at(-1),l=s.frames[0],u=a.frames[0],c=n[i],m=n[l],f=n[u];if(c&&m&&f)if(p<=t.width)e.drawImage(c,-p,h),e.drawImage(m,t.width-p,h);else{let r=p-t.width;e.drawImage(m,-r,h),e.drawImage(f,t.width-r,h)}}else{let r=s.frames.length,a=Math.floor(c/s.duration*r)%r,l=n[s.frames[a]],u=n[s.frames[(a+1)%r]];if(l&&u){let r=i?g*f:0;e.drawImage(l,-r,h),e.drawImage(u,t.width-r,h)}else l&&e.drawImage(l,0,h)}}(r,t,n,i),function(e,t,r,n){let a="";if(r<l.run.start){var i;let e=Math.floor((r-l.start.start)/(l.start.end-l.start.start)*s.start.length);a=null!=(i=s.start[e])?i:s.start.at(-1)}else if(r<l.jump.start){let e=Math.floor((r-l.run.start)*u.run)%s.run.length;a=s.run[e]}else{let e=Math.min(Math.floor((r-l.jump.start)*u.jump),s.jump.length-1);a=s.jump[e]}let d=n[a];if(d){let{scale:r,offsetX:n,offsetY:a}=o,s=d.width*r,i=d.height*r,l=(t.width-s)/2+n,u=t.height-i-t.height*a;e.drawImage(d,l,u,s,i)}}(r,t,n,i))},[t,r,n,i]),null}function f(e){let{currentTime:t,isPlaying:r}=e,s=(0,a.useRef)(null),[i,l]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=s.current;if(!e)return;let t=e.getContext("2d");t&&l(t);let r=()=>{e.width=800,e.height=400};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),(0,n.jsxs)("div",{className:"canvas-wrapper",children:[(0,n.jsx)("canvas",{ref:s,className:"animation-canvas"}),(0,n.jsx)(m,{canvas:s.current,ctx:i,currentTime:t,isPlaying:r})]})}function g(){let e=(0,a.useRef)(null),[t,r]=(0,a.useState)(!1),[s,i]=(0,a.useState)(0),[l,u]=(0,a.useState)(0);(0,a.useEffect)(()=>{console.log("Controller mounted");let t=e.current;if(!t)return void console.log("Audio element not found");let r=()=>{i(t.currentTime)},n=()=>{t.duration&&!l&&u(t.duration)};t.addEventListener("timeupdate",r),t.addEventListener("loadedmetadata",n);let a=setTimeout(n,1500);return()=>{t.removeEventListener("timeupdate",r),t.removeEventListener("loadedmetadata",n),clearTimeout(a)}},[l]);let o=e=>{let t=Math.floor(e/60),r=Math.floor(e%60).toString().padStart(2,"0");return"".concat(t,":").concat(r)},d=l?s/l*100:0;return(0,n.jsxs)("div",{className:"controller",children:[(0,n.jsxs)("audio",{ref:e,preload:"auto",style:{display:"none"},children:[(0,n.jsx)("source",{src:"/music/song.mp3",type:"audio/mpeg"}),"Your browser does not support the audio element."]}),(0,n.jsx)("div",{className:"animation-wrapper",children:(0,n.jsx)(f,{isPlaying:t,currentTime:s})}),(0,n.jsx)("div",{className:"controller-controls",children:(0,n.jsxs)("div",{className:"controller-bar",children:[(0,n.jsxs)("div",{className:"controller-buttons",children:[(0,n.jsx)("button",{onClick:()=>{let t=e.current;t&&(t.paused?(t.play(),r(!0)):(t.pause(),r(!1)))},title:t?"Pause":"Play",children:t?"⏸️":"▶️"}),(0,n.jsx)("button",{onClick:()=>{let t=e.current;t&&(t.pause(),t.currentTime=0,r(!1))},title:"Restart",children:"\uD83D\uDD04"})]}),(0,n.jsx)("div",{className:"controller-track",onClick:t=>{let r=e.current;if(!r||!l)return;let n=t.currentTarget.getBoundingClientRect();r.currentTime=(t.clientX-n.left)/n.width*l},children:(0,n.jsx)("div",{className:"progress",style:{width:"".concat(d,"%")}})}),(0,n.jsxs)("div",{className:"controller-time",children:[o(s)," / ",o(l)]})]})})]})}function p(){return(0,n.jsx)("main",{children:(0,n.jsx)(g,{})})}},8563:(e,t,r)=>{Promise.resolve().then(r.bind(r,7300))},9014:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[233,441,684,358],()=>t(8563)),_N_E=e.O()}]);